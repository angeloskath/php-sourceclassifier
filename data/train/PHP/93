<?php
$input = '1000
XXXT
....
OO..
....

XOXT
XXOO
OXOX
XXOO

XOX.
OX..
....
....

OOXX
OXXX
OX.T
O..O

XXXO
..O.
.O..
T...

XXXO
..OX
.O..
O...

OX.X
XOO.
XXOX
OOXO

OXOO
.XTX
OOXX
OXOX

XOOO
XTOX
OXOX
XOXX

OXXO
O..O
OTXO
XXXX

O..X
O.XX
OXOO
XOXX

OOXO
OXOX
XOXX
XOOX

OXOO
XOOX
XXOO
XXOX

OXOX
XXXO
OOOX
XXOT

XXT.
OXOX
OXXX
OOOO

OX.X
OXX.
OXOO
XXO.

XXXX
OX.O
OXOO
.X.O

XXTX
OX.O
O.X.
OO.X

XOXX
OOXX
XOXO
OXOO

O...
.O..
..X.
X..X

..OX
..O.
X...
....

..XO
.XOX
OO.X
OOXX

..XT
.XXO
XOXO
OOX.

..X.
.OXX
OOOO
TXX.

XXX.
XOOO
XOOO
XX..

XX.O
OOXO
.XXX
O.O.

XXXX
.OOT
O...
XO..

OOTO
OXOX
.XX.
.XOX

O.OX
OXT.
.XOX
X...

XX.O
X.OX
OO.X
OX.O

.XXX
..XO
OXOO
XOXO

O...
.OXX
..OX
X..O

XXXX
XOO.
XO.O
XOO.

OOOX
OXXO
XOOX
X.XT

.OX.
OOX.
.OXO
TXXX

OXX.
....
OXOX
.T..

OXXX
OOOX
XOOX
OXXO

OX..
XOTX
O.O.
X.XO

TOOX
XXOO
XXXO
OOXX

O.XX
O.OX
..XX
O.OX

TOO.
OXXO
X.OX
X..X

XO..
XO.O
XOOO
XXXX

TXOX
OOXX
XXOO
.OXO

XO.O
XOXO
.OX.
.OXX

.OOX
O.XT
.XOX
X.OX

XXXX
TXXO
OOXO
OOXO

OXXO
..OO
.XX.
.X.T

.OOX
O..X
XXTX
OO.X

X.OX
XOX.
TX..
XOOO

T..O
.O..
..OX
XXXO

....
...T
....
...X

...X
X...
X.X.
OOOO

OOXX
.OOX
XOXO
XO.X

OXOX
XOOX
OXOX
OXXO

.O.X
O.OX
O.OX
TXXX

XO..
XO.X
X.OO
X.XO

OX.X
OXOO
.OOX
XX..

X...
.T.O
..X.
..OX

X...
...X
OOOO
.XX.

X..X
OOOO
X..X
XOOX

XX.O
.XOO
.TXO
.XOX

.OX.
.XT.
X.OO
X...

.T.X
....
....
....

OOOX
XOOO
X.TX
XOXX

...T
.X.O
....
....

...X
....
....
XO..

OXXX
OOOX
OOXX
XOXO

...X
..XO
.XO.
XO..

O..X
.OOX
XXXX
OOOX

OXXX
.OXX
OOOO
O.XX

XX.O
.O..
X.T.
.XOO

OXXX
..XT
XO.O
OOOX

....
TOOO
..X.
.XX.

X.O.
X.OO
XTXX
X.OO

....
..X.
....
..OT

XO..
XX.O
..X.
O.OX

XO.X
.OO.
X...
....

XXOO
..X.
O..X
OX.O

XOXX
.O.O
.O.O
XOXX

...O
.X.O
.OXX
XO..

XXXX
O.XO
OX.O
XO.O

XOXT
OOXO
OXO.
X.XX

XXXX
XOOX
XOO.
.OO.

XXO.
.XOO
.TX.
OXOX

XXXT
..O.
....
...O

OXOX
XXOO
OXXT
XOOX

OXTO
XOXX
XOXX
OOXO

XXXX
.XO.
OXO.
OXOO

OOX.
.OXO
XXXT
..XO

.X..
....
OTOO
X..X

O.OX
XXOX
TXOX
OOXO

...X
....
....
..T.

TXXX
O.XO
OOX.
..XO

X..O
.XO.
..X.
.O.X

OXXX
OTOX
OOXX
XOOX

O.XO
OOXO
OOXX
XXXX

...X
OOO.
OX..
.XX.

XOO.
XXXX
O.XO
O.OX

XX.O
.TOO
OOX.
X.XX

.XOO
OXO.
OXXX
.X..

OOOX
XOTO
XXXO
XXOX

....
T..X
....
....

X.XO
OOOO
.XXO
XOXX

X..O
.XOO
XXXX
OOOX

.XXX
OOX.
.X..
OXOO

X..O
TO..
X...
X...

OXXX
O...
O...
T...

OXXX
OXXX
XOOX
OOOO

..TX
X.XX
XOOO
XOOO

.OX.
.OXX
.OXO
TO.X

.X.X
...X
.OO.
OX.O

OX.X
OOOX
OXOX
.TXX

..O.
T.OX
.XO.
X.OX

X..X
OOOO
X..X
XOOX

XO.O
TXOO
..XO
.XXX

XX.O
XX.O
O.XO
XO..

.XO.
XOOX
XXOO
.T..

...O
X.OX
XO.X
O...

OOXO
.XXX
XOX.
OXOO

....
X.XX
O...
..O.

.OOX
XXXO
OX..
XO..

XOOX
OOOO
XXOX
OXXX

.X.O
.O.O
..XO
XXXO

XXOX
OX.X
XXTO
OOOO

.X.O
OX.O
X.OT
..X.

XO.O
OTXO
OXX.
XXOX

TXOO
XXXX
OOXX
OXOO

OOOX
X.TX
X.XX
OOOX

OOX.
.XXO
OXXO
OXTX

XX.O
O.XO
O..X
OOXX

XTOO
OOXX
XXXX
XOOO

XTX.
OO.O
X...
X.XO

OX.X
O.XO
OX..
X...

OX.O
XXOX
XO.O
OXXO

X..O
OXO.
XXXT
OO.X

XXO.
XOXO
X.O.
XOOX

..O.
....
..X.
....

XOXT
OXOX
XOOX
OX.O

TOXO
OXOX
XXXO
XOXO

XXXX
OX.T
XOOO
O...

X.OO
X..O
X.OO
XTXX

OXOX
XOOX
OOOX
XXXO

TOOX
XOXX
XOOO
OXXX

....
TO..
....
.XX.

OXOX
OXOO
TXOO
X.XX

O..X
.OXX
..O.
.X.O

XOOO
XXXX
O.X.
OO.X

...O
..XO
..XO
XX.O

X...
O...
...T
.X..

XOOO
XOOO
XXXO
OXXX

..O.
XXTX
..OX
.O..

..X.
..XT
.X.O
OO..

OOXX
XXOT
XOOX
XOXO

XOO.
OXOO
XOXO
XXXX

TXX.
O..O
OX..
OX..

O...
.O.O
.OXX
..XX

....
.XXX
OOOO
X...

XO..
.XOO
OOX.
XXTX

...O
..XO
X.XO
O.XT

X.XO
XOX.
OOX.
.OX.

....
...O
.X.X
..T.

....
....
....
T..X

OOXX
O.XO
OXOX
XXOX

OXOO
OOOX
.X..
XXXX

...T
..O.
XO..
OX.X

....
...O
XXXX
OO..

XOXX
XOX.
.OT.
.OO.

X.OO
XO.O
XXXX
X.OO

OOXX
XXOO
XXOX
TOXO

OOXX
XOXO
XOT.
XO..

OXOO
.X.O
OX.O
XXXX

.X..
X...
O...
O.X.

XX..
.OXX
.X..
OOOO

XTXO
XO.X
O.XX
OOXO

OOOX
X.TX
X.XX
OOOX

OOOT
X...
X...
X...

...O
....
XXXX
..OO

XOOX
OXOX
XXOX
OXOO

O..O
.OXX
X.O.
XX.O

XX.O
XOOO
.O.X
O.XX

....
....
....
....

XXTX
.OOX
O..X
OO.X

XXO.
.T..
.OO.
OX.X

.OOO
XOX.
XXXO
XXO.

..O.
X.X.
....
T.O.

XOOX
OX..
XXXO
OTXO

O..X
OOXX
OXOX
XO.X

XO.O
..OX
.OX.
OXX.

.O..
XT..
....
....

OOXO
XOXX
OXOX
XOXO

.XO.
.X.O
TXO.
.X..

...X
.XO.
.X..
O...

X.TO
OO..
OX..
XX..

....
....
.O..
.X..

XXOO
XOOO
OXOX
OXXX

XOOO
..TX
XOX.
O.X.

...O
..XO
X..O
XTXO

.OO.
.OX.
.XX.
.X.O

O.OX
OT.X
XXO.
OXXO

X.OO
.XOX
XOXX
OOXO

OX.X
XXOO
TOO.
X...

O..X
OOX.
X..X
.XOO

O...
XXXX
..OT
O...

OXOX
XOXX
OTXO
XOXO

OOX.
..XO
..X.
..XT

.X.O
.OO.
.T..
.XX.

XOOO
.X.O
XXXX
OO.X

O.XX
.O..
OX..
....

XXOO
XOOO
XOXX
XOTX

O..X
OOXX
.XOX
XOOX

.X.T
XO.O
...X
..XO

..T.
...X
....
....

TOXO
OXXX
XXOO
OXXO

XOOO
.O.O
XXO.
X.XX

OX.X
XX.O
.OOX
TO.X

OXX.
XOOO
TOXX
XXOO

XXXX
.T.O
.O..
O...

XOXX
XOTX
OOXO
OXXO

..OX
..X.
.TO.
X...

XXX.
XOOO
XOOO
XX..

X...
....
....
....

X..O
XOOO
XOO.
XXXX

XO..
.O.O
XT..
..X.

X..X
....
.XX.
OOOO

OXOT
X.OX
OXXX
OOXO

..XX
OXXO
OXO.
.OX.

XXXX
OO.X
OO.X
O.OX

X..O
.OXO
XOOX
OXXT

XOOO
XOXX
XOXO
OXOX

OXXO
OOOX
XXOO
XXOX

XX.O
.X..
OOOX
XXOO

..OX
X.XX
T.XO
OO..

.XXX
OOXX
OXOO
XOOX

OXXO
OOTX
OX..
XXXO

XOX.
OOX.
XO.X
TOXO

..O.
...T
....
.X..

XXX.
XOOO
XOOO
XX..

XOXX
XOOX
OOX.
O...

OX.O
OXO.
.X.O
TXXX

OXOX
XXOO
XOOO
XXT.

X.XO
X.O.
XOO.
OX..

.O.T
..X.
.XOO
X..X

OTOX
.XOX
XOO.
.XOX

OO.X
XOOX
X.X.
XOOT

OX.O
.X.X
..XO
.O.X

OOXT
XOOX
OXOX
XOXX

XXX.
XOOO
XOOO
XX..

OXOO
XOXX
OXO.
OXXT

OXOX
OOXX
OXXO
OOXX

T...
.OO.
.XXO
XX.O

..XO
..OX
XOX.
O...

X...
X..O
XO..
XO..

OXXX
O...
O...
T...

O.XO
O.O.
XT.X
OX.X

XOOX
XXOX
OOOO
OXXX

.OXX
O.XO
OXXO
XOX.

TOOX
OX.X
XOX.
XOOX

O.XO
XXXX
.OXO
O.XO

OXOX
XOXX
OOOO
XOXX

O.X.
.OXX
..O.
.X.O

.X..
XOXO
.OX.
O..X

OOOO
X.XX
.XOO
OXXX

TXX.
.O..
..O.
..XO

...X
....
....
....

OOOX
XXOO
OOXX
OXXX

OO.X
.OX.
OXOO
XXXX

TOO.
XXO.
XXOX
XOXO

X.OO
T...
X.O.
X.X.

OO.X
OO.X
XXXX
.OOX

OXO.
X.O.
XXXT
XO.O

X.OO
OXT.
.XOO
XXOX

X..X
...O
.O..
...X

...O
.O..
XXXX
T.O.

OOOO
.T.X
..X.
X.X.

OO.X
XXXX
OO.X
.OOX

O.O.
T..X
O.XX
OX..

XOX.
OXOO
OOX.
XX.X

X...
XTOO
..XO
...X

OXOX
OOXO
XXOO
OXXX

XO.O
XXOX
OTXX
OXOO

.OXO
OOXO
X.XX
OXTX

O..X
..OX
..OX
...X

O...
...X
....
.X..

.O.X
.XXO
OXOX
.O.T

XOXX
TXOX
O.OX
XOOO

OXXO
O..O
OTXO
XXXX

O.OX
.XTO
.X..
X...

OX.X
OOOX
XOXO
XXXO

X.OX
OOOO
T..X
XX..

XOOX
.O.O
.X.T
.XOX

OXXO
O..O
OTXO
XXXX

XO.O
X..O
X.OO
XTXX

O..O
.OXX
.XOX
..XO

XXO.
XXOX
XOOO
OX.O

...O
XOTX
.O.X
O.X.

O.XO
.OX.
XTXX
.OXO

OXXX
.O.X
XTO.
OO.X

OOXX
OTXX
XXO.
OOXO

..XX
...O
OOOO
.XXX

XXXX
....
OOT.
...O

.X..
XOX.
OO.O
..X.

..T.
.X.O
...X
..O.

XOOX
OOXT
OXOX
XXXO

TXOX
XOOO
..OX
X.XO

.OXO
XXO.
TXO.
XOX.

O.OO
.X..
X.XT
X.OX

..OX
.O.X
..X.
.O..

..O.
.O.X
....
...X

..XX
OOOO
X.T.
...X

OO..
XXOX
OOTO
X.XX

XOOO
XXXX
.OTO
OX.X

OXXO
OOOX
OTX.
OXXX

OOTX
X.OO
XXXX
X.OO

...O
..O.
XOXX
T...

XXOO
OXO.
X.XO
...X

O..T
X.O.
XO.X
O.X.

OOOT
XOXX
XXO.
OXOX

.XO.
....
....
....

XOOX
X.OO
OOX.
XOXX

XX.O
X.XX
O.O.
.OOT

...T
....
....
X...

OOXO
.OX.
O.XO
XXXX

XXXX
XOTO
.OXX
.OOO

.OXO
OOX.
O.XO
XXXX

OXTX
XOXO
OOXO
XXXO

.XO.
.X.O
TX.O
.X..

.OX.
XOXO
O.XX
XO..

OO.X
.OOX
.O.X
TXXX

OX.O
OX..
TXXX
.XOO

O.XO
TXOX
O.XX
O...

XOXO
XXOX
OOOO
XXXO

XXOO
.OX.
..X.
XOO.

XXO.
OOXO
XXX.
.O.O

..X.
....
....
....

TOXX
OOXO
XOXX
OXOX

OXXO
XXOO
TOXO
XXOX

X.O.
XXOT
OOXX
XOXO

XTXX
XOO.
X.OO
XO..

OOXX
OXOX
XXXT
OOXO

X...
....
....
...T

OXOX
OXOX
XXX.
TOOO

TXXO
XOXO
OOXO
XXOX

...X
O..X
.OXO
X.XO

TOXO
XOXX
OXXO
XOOX

TXXX
..XO
O.XO
OOX.

.T..
.O..
.OXX
OOXX

.X.O
OXXX
XOOO
.TOX

..OX
XTXX
O.OX
OO.X

X.OO
OXXO
.XXO
OX.X

X...
.X..
OOOO
.TXX

OOOO
XX..
T..O
XXX.

XXXO
OXOT
OOXO
XXOX

XXXX
O.TO
..O.
....

OXTX
OOOX
XXXX
XOOO

XTXO
OXXO
OXOO
OXXX

XXXX
O.XO
OXOO
X..O

XOOO
OX..
.OXO
XXXX

...O
XXOX
.OXX
OXOO

..XO
..T.
.OX.
..X.

OO..
XXXX
O.XX
OOXO

.X..
TOO.
O.O.
XXXX

O.OX
XXXX
OO.X
.OOX

XXOX
OOOX
TOXO
XXOX

XOOX
XXOO
.OXX
XXOO

XOO.
XXXX
OOX.
OO.X

..X.
.X..
...O
....

XXXO
.XOO
OOXO
OXX.

OXOX
.XX.
X.XO
.OOO

OXXX
OTXO
O.XX
OXOO

XXX.
X.OO
.XO.
..O.

..XO
O.X.
.OX.
..X.

XXOO
OOXO
OXXO
XXXO

XXOX
OXXX
OOXO
OXOO

X.OX
OOOO
XX.T
XXO.

XXOX
OOXO
OXXO
X.OX

...X
....
....
....

X...
.X..
O.X.
.O.T

OX.X
.T.X
..OO
.X.O

OOXO
XOXO
XXOX
XXOO

O.OX
XXX.
XX.O
XOOO

XXOO
XOOO
XXOX
OXXO

OXXX
XO.O
.OO.
X.XO

O.XX
.OXX
.OT.
...O

XO.O
OOXX
...X
XXO.

...X
X.O.
.OT.
X...

.O.X
O.TX
OX.O
XXXO

XXXX
XOOX
XOO.
.OO.

.OOX
..OO
.XX.
TOXX

OXXO
OTOX
XXXO
OXOX

X...
OXOX
....
OOX.

XO..
XOOO
TO..
XXXX

XXOX
XOXO
OXXO
XTOO

X.XO
OXX.
.OXO
OOXX

XOOX
XOOO
OOXX
OXXX

....
.XX.
O...
....

....
....
T.X.
....

O...
.TX.
.XO.
..XO

.O.X
OOX.
TXXX
X.OO

OXXO
O..O
OTXO
XXXX

XOTX
OXXX
OOOX
XXOO

..O.
X.XO
....
....

OOXX
.OTO
.XX.
XO.X

XXO.
OXOO
.XXO
OX.X

T...
.XX.
....
.O..

XOXO
.XXO
O.XO
O.XX

OO.X
X.OX
OXOO
XXOX

XOXX
XXXO
TXOO
OOOX

....
.XO.
X...
TX.O

OOXX
XO.X
.XT.
.O..

..OX
.OX.
.XX.
OO..

..X.
....
....
..T.

.O.O
XTOX
.X.O
..XX

.XO.
OXOX
XOXX
OOXO

X...
T...
...O
....

OXOO
XXOX
XXXO
OOOX

.XX.
...X
....
.O.O

X..O
.XTX
OOXX
O.O.

..T.
.O.X
OX..
...X

XX..
.OXT
O...
X..O

X..X
..OX
...O
OOTX

....
.O..
.X..
....

O.OX
X.O.
T..O
.XX.

..O.
.XO.
..X.
...X

X.O.
TXO.
XOX.
XOOX

XXXX
X...
XOOO
XOOO

OXOO
XXOX
XX.O
OOTX

XOOX
O...
X..O
X..X

OTXO
OOXO
OX.X
OXXX

XX..
.OXO
....
.O..

.O..
.T..
.X..
...X

O.XX
XOOX
.OT.
X..O

XOXO
.XXX
XOX.
.OOO

...X
.TOO
..O.
XX..

OOXO
OXOX
OXXO
XXOX

XXXX
XO.O
XOO.
XOO.

OXOO
.XO.
XXXX
OX.O

OXOO
XXXO
OOXO
TXXX

X..X
OOOO
X..X
XOOX

XOXO
TOOO
XXXO
.XXO

OXXX
O...
O...
T...

OOO.
X...
XXXX
O.OX

XXOO
XXOO
TOOX
XOXX

X.OX
X..O
.XO.
....

XOX.
X.T.
XO.O
X..O

XOXO
XXOX
XOOO
OOXX

X...
....
...X
...O

X...
OOO.
XXXT
....

.X.X
TX.X
OOXX
OOOO

TXXO
OXOX
.OXX
XOOO

XXTO
.OOO
OXOX
XXXO

O.XX
O.X.
.XO.
..O.

XOTX
OXXO
XOOX
XXOO

....
....
...X
....

.XOO
XXTX
OXO.
OX..

O.XX
TOXX
OO.O
O.XX

OOOX
.OOX
.O.X
XXXX

..OX
..T.
OX.X
X..O

T.XO
OXXO
.X..
OXOX

XXOX
OOXX
OXOX
OXOO

XTXX
XO.O
X...
XOOO

XO.O
OXO.
XXXX
O.OX

XOX.
OOXX
XXXO
XOOO

XOOX
XXOX
XXOO
OOXT

XXOO
XOXX
OXXO
XOOO

.OXX
OOXX
.XX.
OO.O

XOXO
OOXO
OXXO
XXOX

O..X
.OX.
.X..
X.O.

....
....
....
...X

XOXO
XX.O
XOTX
OXOO

XXOX
OOXX
OXXX
OOOO

.XX.
O.X.
.O..
.OXT

...T
..X.
.X..
XO.O

TO..
OX..
..X.
...X

O.XX
OOO.
XXOO
XXXO

.OOX
..XO
.X.O
X..X

XXTX
..OO
.O.O
OXXX

XXTO
XO.O
OXX.
XOOX

OX..
O..X
O.T.
O.XX

O.X.
.OXX
OXOX
OX.O

.OOX
XXXX
OOOX
..OX

XX.O
XOXO
OOOX
OXXX

...O
XXXO
X.TO
...O

....
....
...X
TOX.

X..X
OXOO
TXOX
OOXX

.OXO
O.XO
..XO
TXXX

.XX.
.OO.
OXXX
XTOO

....
X...
..O.
.T.X

XXOX
OXOX
XOXO
OXOO

OOOX
XXOX
OXXO
TOXX

XO.T
XXOX
.XOX
OOXO

XXXX
O.T.
.OOX
XO.O

OXXO
XXOO
XOOT
XXOX

....
XO.O
.X..
T.XO

X...
....
..OT
....

O.X.
...X
..O.
T.OX

OOOT
..X.
....
X.X.

..OO
..XO
...X
..X.

...O
...X
.X..
.OT.

XOOX
XOXO
XXOX
OOOX

.XOX
XOO.
.XOX
O..X

OXOX
XXXO
XOOO
XXOT

.XOO
O..X
OXXO
XOXX

XXXX
OXO.
OXO.
OX.O

O...
X.X.
....
....

XX..
...O
O..T
X...

XOX.
T.X.
OOXO
O.XX

XXOO
XXOX
OOXX
XOOO

OXOO
XOOX
XXOX
XXOO

.O..
X..X
...O
XO.X

XOOO
XOXX
XXOO
OXOX

XOOX
XOX.
XX.O
X.OO

OXOO
XOXO
OOXX
XXXO

XOOX
OXXO
XTOO
OXXX

X..O
..O.
.T.X
OX..

OO.X
..X.
.XO.
X...

X...
X...
.O..
....

XOXO
OXTX
XO.O
OXOX

X..O
..OX
XOXO
O..X

XXOO
OOOO
XXXO
OXXX

.T..
.X..
.XO.
OX..

....
OOX.
OXT.
..XX

OXOO
XOXX
OXXX
OOXO

XO.O
.XOO
.OXO
XXXX

...X
....
..T.
...O

OXXX
XOXX
XOOX
OOOO

XXXO
OXXX
OOXO
XOTO

.X..
....
...X
.TOO

XXXX
T.O.
...O
O...

O..O
X.OX
.X.T
....

XO..
OTX.
.OX.
X.OX

.OOX
O.OX
XXXX
O.OX

X...
.X..
OXT.
O.OX

OXOO
XXXO
OXXO
OOXX

.XXO
XX.O
OO.O
XXOX

OXOX
OOOO
XXOX
XOXX

OXXO
XOXO
XOOX
X..O

XO.X
O.OX
OXXX
O..O

OOOX
OXOX
XOXT
XXOX

XTXO
XXOO
OOOX
XOXX

XOX.
..O.
XXTO
OO.X

OXO.
.XO.
OXOO
XXXX

OOOO
XX.X
X..X
.XOO

OXOX
.XXO
OX.O
X.OX

.X.X
...O
X.O.
.T..

OOXX
XXOO
XXOX
XOOO

XO.O
X.O.
XOXO
X.X.

.X..
OX.O
...X
O...

OO..
XO.O
TXXX
XOX.

OOXX
OOX.
XXX.
.OO.

.XO.
X.O.
..OX
.TOX

.OX.
..XO
.XT.
OOXX

OOX.
OOTX
.OXX
X.X.

OO.X
OOX.
OX.O
XXXX

X...
OX..
.OXO
...X

XOXT
OXXO
OOOX
XOXX

OOXO
XXXX
OXXT
OOXO

XOXX
OOOX
OXXX
XOOT

XOOX
OOX.
XOOT
XXX.

.XOT
X.XO
OXXX
XOOO

XXTX
.XOO
OXOO
.X..

.XOX
.X..
OOOO
X.XT

OX.O
XOOO
.XO.
XXXX

OXXX
XOOO
XOOX
OXOX

.O.X
XOXX
..XO
...O

XOXO
T.OX
XOXO
XOX.

.OX.
OXOX
XOX.
....

OXOX
XXOO
OXXO
XOOX

OX.X
.O.X
X.O.
XO.O

O.OX
O.OX
XXTX
O..X

.XOX
OOX.
.X.O
XX.O

O.XO
XXOO
XTXO
O.X.

O.TX
OO.X
.XO.
OXXX

X..O
...X
.O.O
.X.X

...X
OOOO
T.XX
OXX.

X...
.O..
....
X...

X..O
XO..
XTXX
XOOO

TOXX
XX..
XOX.
OOOO

OO.T
XXXX
OX.X
OXOO

OOOT
X...
X...
X...

XXXO
O.XO
XOXX
.OOO

....
...O
..X.
....

XOXX
.OOX
OXOT
X.OX

OXOX
XXOO
OXTO
XXXO

.OXO
XXXX
..XO
OOXO

X.X.
..OX
X.O.
OT.O

.XXT
.O.O
O.X.
....

XOOX
OXXX
OOXO
OXXO

OXXX
O...
O...
T...

....
.O..
...O
X.X.

XOOX
XOOX
OTXX
XXOO

.XOX
.TOX
..O.
X.O.

XO.X
.OO.
.XXX
O...

OXXX
OXOX
OXOX
XTOO

....
....
..OX
.XOX

...O
.X.T
X..X
O...

OOXO
XXXX
OOXX
OTXO

OXOT
XO.O
XOXX
XOOX

OXXO
OOXX
XOOO
XXXO

OOXX
OXOO
XXTX
OXXO

....
....
TX..
....

XOTO
OXXO
XOXX
XOXO

.OT.
O.OX
XO.X
.X.X

OOOO
XOXO
OXXX
XXXO

....
O...
.X..
....

OOOX
XXOX
XOXO
XOOX

XXXX
.XOO
OXO.
OX.O

XOXX
.XXX
OTO.
XOOO

XO.O
X.OO
XXXX
XO.O

O.XX
.OXX
OT.X
XO.O

OXXO
X.XO
OXTX
OOOX

OOOX
X.TX
X.XX
OOOX

..TX
OOXO
.XXO
X.XO

OXOO
XX..
OOXX
O.XT

..XO
.OO.
XO.X
OX.X

...X
...X
..OX
OO.X

O.OX
OO.X
XXXX
O.OX

O.XX
.X.X
XOXT
OOOO

.O..
..XO
TX..
..X.

O..X
.OX.
..OX
X..O

XOOO
OXXO
XXXX
OXTO

..O.
XXXX
OOO.
.X..

....
XX.X
O...
O..T

.XTX
...O
....
....

.OOX
XXTX
OO.X
..OX

....
..X.
...O
....

OXOX
.XXO
.X.O
XXOO

XOOX
XOXO
XX..
XOO.

XXXO
XOOO
OOXX
XOXO

XOOX
OO.O
XTXO
XOXX

OO.T
..X.
.X..
X...

XXXT
XOXO
OXOO
OOXX

O.X.
.T.X
..O.
X..O

OX.X
OOO.
XTOO
XXX.

XOX.
..X.
O.XX
TOOO

..X.
X..O
X..X
.O.O

XXOX
.OXX
OXX.
OOOO

....
O...
O.O.
XXXX

.O..
X...
....
..X.

.OOX
...X
..X.
....

....
..O.
X..T
OX..

XT.X
.OOO
....
.X..

OX.X
OXTX
O.O.
OOXX

O.XX
OTO.
OXX.
OX..

O.XX
O.XO
OXTO
X.X.

XXXX
XOOO
X.O.
XO.O

OX..
.O..
X.T.
.X.O

XO.O
TX..
XOX.
XOOX

OT.O
.X..
.X..
.X..

X.X.
OX.O
OXXO
.O.X

.XTX
..O.
.OO.
XXO.

OXOO
OX..
XXXX
OX.O

.XXO
X.OX
XOXO
OOOX

..X.
X.XO
OOXO
..X.

.O.X
XT.X
.O..
.O..

O..X
OXO.
...O
.XXX

XXOO
.X.O
OXX.
OXOX

OXXO
X.OO
OOX.
T.XX

.OOX
O.XO
XXTX
X..O

O..X
..X.
O...
..T.

XO.X
X..O
X..O
XOXO

O.XX
OOXO
.XXO
XOX.

....
.O..
....
TX..

OXOO
OOOX
XOXX
OXXX

OO.X
O.X.
XXXT
...O

XO.O
XXXO
OXXX
OTOO

XXTX
OXX.
.OOO
..OX

OOOO
XXOX
XXOX
XOOX

.O.X
..X.
.XO.
X..O

...X
XOX.
..OO
X...

OOXX
X..X
.OOX
OX.T

XXXT
XXOO
XOOO
XOOX

....
.XOX
....
XO..

O..X
..TX
OX..
XO..

OX.X
OX.X
X.OO
TXOO

OX..
OXOX
X...
...T

OX..
.OX.
.OXO
XX.O

OOXX
OOX.
.XT.
XOX.

X.O.
X.OO
XTXX
XOO.

XXXX
XOOX
XOO.
.OO.

OOOO
OXX.
.XXX
..XO

XXOX
XOTO
XO.O
OOXX

.O.X
X..O
OOXO
X.X.

XO..
X.OO
XTXX
XOO.

....
.O..
....
X.TX

XXOO
OXXO
OXXX
O.OX

OOOX
XXT.
XXXO
XOO.

XXXO
OOXO
XOXO
XOTX

OXOO
OXOT
XXXX
OXXO

O.OX
OOXX
.X..
X.XO

OTXO
OO.X
XX.X
OXOX

TXXX
OOX.
.XO.
XOO.

XXXO
TXOX
XOOX
XOOO

....
X...
....
....

O.T.
.XOX
XXOO
..XO

....
....
X..O
.XO.

XT..
....
....
....

OXOO
OX.X
OOXX
TXXO

....
....
X.O.
....

XXXO
XXOO
XOOO
OXXO

.XXO
OX.O
XXXO
.OOT

TOX.
X..O
XXXO
XO.O

XXX.
XOOO
XOOO
XX..

OOOT
X...
X...
X...

...T
.OOX
XOXX
.O.X

..OX
XXXX
OXOO
XOO.

XO..
OXOO
OOX.
XXXX

..OX
OXX.
.TO.
XOX.

O.XX
OXXO
.T..
X..O

XOOO
XTOX
OXOX
XOXX

...X
OOOX
XXXX
OOOX

....
.O..
TXXX
.O..

.X.X
OOXO
OXOX
XOX.

OXXO
O..O
OTXO
XXXX

OXXX
XOO.
OXXO
OXXO

X.T.
.XX.
OOXO
OOXX

TXXX
OXOO
X.OX
OXO.

OXOO
XXXO
XOOO
XXXO

XO.X
X..O
.OO.
X...

OXOO
OXOX
XOXX
XTXO

T.OX
X...
..O.
.OX.

XTXX
.X.O
.OXO
OO.X

.X..
.XTO
.XOO
.X..

.O.X
.XX.
OX..
XO.O

XOXT
OOXO
XXXX
OOOX

XOXX
XXOO
XOXO
OOXO

XOOO
XOXO
XOXX
OXOX

X.OO
OXOO
O.X.
XXXX

O.OX
OXTO
.OX.
XXXO

.XOX
OXOX
...X
O.OX

X..X
OOOO
X..X
XOOX

OXXO
OXXX
XOXX
OOOO

....
.X..
....
T...

XXOO
.OOX
XTX.
OX.O

...X
.O.X
O.OX
OX.X

OXX.
OOO.
X...
X...

XOX.
OXOX
.TXX
OOOX

OOXX
XOXX
XOXO
XOOO

XXOO
OOOO
XXXO
XOXX

OXXO
OOOX
XOXX
OXXO

OXTO
OOXO
OXXO
XXXX

OT.O
X.X.
X.OO
.XXO

O.OX
.OXO
.XO.
XTXX

XOO.
XOO.
XXXX
XOO.

.X.X
....
....
...O

....
....
X...
...O

....
....
....
T..X

OX..
OXXX
OO.T
..XO

XXOT
OXOO
XOOX
XOXX

..XO
.OOX
OTXX
O..X

.OOO
.XOO
XOXX
XXTX

..O.
OOTO
OXX.
XX.X

OXOX
XXOX
OXOX
XOOO

OXOX
.OTO
OXXO
X.XX

OOX.
XO.O
..OX
XXXO

OXXX
OOXX
XOXO
OTXO

O...
O.XX
TX..
O...

X..X
OOOO
X..X
XOOX

XOX.
.TO.
XO.X
OO.X

....
..X.
....
...O

OXXO
XXOO
XXXO
OOOX

OXX.
X.O.
..XO
.O.X

XXXO
XXOO
OOXX
OOXO

OOOX
XOX.
XXOX
T...

XX.X
OXO.
.OX.
XOOT

XOOO
XXXX
XOOO
XOXT

OXXX
OXOX
XOOO
OX.X

XXOO
XXXO
OOOO
OXXX

.OXX
OOX.
OX.O
XXXO

O.OX
X.XX
O.XO
T...

OOXO
XXOO
.OX.
TX.X

O.X.
O.XT
O.X.
..X.

XXOX
OOXX
XOXO
OXTO

TOXO
XXXO
XOOX
OXOX

XXOX
..OO
.OT.
X.OX

..X.
TO..
OOX.
XX.O

XOOO
X.XO
XXXO
X.O.

XOOO
XXXX
XOTO
OXOX

OXXX
OOXO
XOXT
OOXX

OXXX
XXXO
XOXO
OOOO

.OXX
OO.X
XOX.
TOOX

XXTX
OOXO
.X..
XO.O

OOOO
XOXO
XXXO
XXOX

XO.O
X.OX
OX.X
TO..

....
..O.
....
.X..

.O.X
...X
X...
...O

XXX.
O.OX
OO..
XOX.

OXXX
XOXO
OOOO
XXXO

X.OO
.XOO
XXX.
.XOO

XO..
XOX.
XOT.
.O..

.O.X
..OX
.X.T
..OX

TXOO
OOOX
XXXO
XXOX

..O.
...X
....
T...

.OOX
XOOO
X.XX
XOOX

XX.X
....
O.O.
....

XO.X
OOOO
XOXO
XX.X

O.X.
TXOX
OX.X
O..O

..O.
XO..
..X.
.X..

OO..
OTXX
XOXO
O.XX

....
X.X.
X...
OOOT

OOXX
OXXX
OOOO
XXXO

OXOO
XXXO
XXXO
OOXO

OOOX
OXXT
OXOX
XOXX

XOOX
.XOX
.OXT
.O.X

.X..
X..O
.O..
..T.

OOO.
XXOX
X.OX
...X

O...
XXXO
OXOX
XOOX

XOXO
XOOO
OOXX
XXXO

..X.
..X.
OXT.
.O..

XXXX
OOXO
OX.O
X.O.

XO.X
....
.XO.
....

XXOO
X.OX
OOOX
XXOT

XX..
....
....
.OOT

XO..
OOX.
.XX.
.OX.

..T.
.OXX
....
....

...O
..XT
..X.
OX..

X.OX
XOXO
TX.O
X..O

O..X
OOOX
XXXX
OO.X

O..X
OOXX
.XOX
XOOX

.O..
O...
XXXX
O...

O.OX
OXOX
.O.X
X..X

.XX.
OOO.
XXXX
OXOO

X.XX
..OT
.XOO
...O

..OO
O...
XOXX
.X..

OO.O
XOX.
.XXX
T..O

X.OO
X.O.
.OXX
O..X

O.OT
O.X.
XX.X
X.O.

OOOT
....
XX..
.X..

XXOO
OXTX
OXXO
OXOX

.OXO
XOXO
OXXX
.OXT

XO.O
.XO.
OOXO
XXXX

XXXX
OX.O
OXOO
.X.O

OX.X
OOX.
OXOX
XXO.

O.XO
XXO.
X...
XXOO

OOOT
XXXO
OOXX
.XOX

.OXO
.O.X
XOOX
.OXX

XOT.
.OXX
OO..
.OXX

O.OX
..O.
T..X
..X.

XTOO
XOOO
XXX.
OXXO

XXXX
.TO.
XX.O
.OOO

XO..
.XO.
OOXO
XXTX

TXXO
XXOO
XXOX
XOOO

OXXO
O..O
OTXO
XXXX

XO.X
XXXX
O.OO
O...

OOOO
OXXX
XXOO
XXXO

...X
O.O.
..X.
.X.O

OXOO
XXTX
.X.O
OX..

.XOO
X..X
O...
....

...X
.OO.
TX.O
X..X

XXOX
XOOO
XOXX
XOTO

....
...T
....
X..O

OO.X
XX.T
...X
OO.X

X..O
...X
O.T.
....

XXOT
OOXX
OXOX
XXOO

OXX.
XO.O
.XOX
...O

.XXO
OXO.
XOXO
OXOX

XOT.
XO..
XOX.
.O..

OO.X
.OX.
OXT.
.XXO

.X..
XXXX
OXOO
OXOO

X...
X...
OOOO
X.X.

TXXX
OX.O
OX.O
.XO.

X..X
.T.X
.OX.
OOOX

T...
.X..
..O.
.XXO

OOOO
XXXO
XOXX
XXOO

OX.O
.OOX
XO..
TX.X

XTXX
XOOO
OXXX
OOXO

X..X
OOOO
X..X
XOOX

O.OX
.OXO
OX.O
XXXX

OOOX
XXOX
OTOX
OXXX

OOXO
XOXO
.XXX
XOXO

X.X.
.O..
..T.
...O

OO.X
XXX.
.OT.
..OX

X..X
OTO.
XXO.
.X.O

OOOX
X.TX
X.XX
OOOX

....
....
X...
OX..

X...
O...
TOX.
....

..XX
OX.X
O.OO
X.T.

XO.O
XXXX
OOXO
O..X

..XO
.OXT
XOXO
..X.

TXXO
XOOX
OXOX
OOXX

....
.T..
..X.
.O..

.OX.
X.TX
.O.O
.X..

.OXO
TXXO
..O.
..X.

O.XO
XTXX
O.XO
.OX.

OX.O
TX.O
.X..
.XXO

OX.X
XOX.
O.OX
...O

....
..XO
....
...T

OXXX
TXOO
XXXO
OXOO

.OXO
O.X.
OOX.
XTXX

OOXT
XXXX
XOOX
XOOO

OXXX
XTOX
XOXO
XOOO

XOOT
XXOO
XOXO
XOXX

....
.TO.
XXO.
.X.O

XXOO
XOOX
.OXO
XXXO

OOX.
.XX.
..TO
..X.

.X.O
.XOX
.OX.
O...

OXXX
O...
O...
T...

OOOO
X.OX
.TXO
XX.X

XOXX
.OXO
OXOX
XOOX

O.OX
..XO
.X..
X...

OOOX
OOX.
.X..
XXTX

XXXX
O.XO
OOX.
O.XO

...X
XTXX
.O..
O.O.

..X.
.OO.
..O.
XXX.

.TO.
XXO.
....
...X

OOXX
OXX.
.OOX
.XO.

XOOX
XXXO
XXXO
OOOO

OOOO
OXXO
OXXX
XOXX

...X
T..O
.OXX
.XO.

OOOX
X.TX
X.XX
OOOX

XX.O
...O
....
TX..

O..X
.O..
X...
X...

XXX.
XOOO
XOOO
XX..

XOOX
OOOO
X.XX
...X

XOXX
XOXO
XXOX
OOOO

XOOX
XOOO
OXOX
XXXO

..XO
O...
...X
OX..

XXXX
OXOO
.OXO
.O.X

XOO.
.X..
..T.
...X

OOOO
XXOX
OXXO
XXOX

XOTO
.XX.
O.XO
.OXX

.OOX
OOXO
.XO.
XXXX

TOX.
XO.O
O.OX
XXXO

OXX.
OOXX
OOXX
XOXO

O.TX
X.XX
X.O.
O.O.

.XT.
XXO.
..O.
..O.

OOOX
TOXX
XXOO
XOXX

.XOO
XXXX
.X.O
OXOO

.XOO
.XO.
.TXX
O...

OXOO
XX..
XXOO
...X

X...
O..X
.XTO
.O..

..T.
....
O..X
....

O...
..XX
..OX
..XO

.XXO
X.O.
.O.X
O...

O.OO
XXOX
XXXX
XOOO

..X.
TOOO
X...
X...

OO.X
TXOO
..X.
O.XX

XOTX
OOXO
XOXX
OXXO

XO.X
.O..
.OTX
XO..

....
...O
XXXX
..OO

OXOX
XOOX
XOOX
OXXO

OX..
..X.
..OX
XO..

OOXX
.OXO
XX..
X.O.

O..X
O...
....
.X..

OOOX
OXOX
XOOX
XXXO

OOXO
OXOX
OXXX
XXOO

TXXX
OXX.
X..O
.OOO

OOOX
O..X
.O.X
XXTX

X.X.
OOOO
.OX.
XOXX

TXXX
XOOX
OOXX
OXOO

T...
XO.O
XXXX
O.O.

XO..
OXO.
.XX.
..O.

OXOO
XXXO
OOXX
XOXO

XOXO
XOXO
XOOX
OOXX

OX.O
TXXX
OOX.
XOXO

XXOO
XOO.
OXXX
OXTO

X...
..O.
.XO.
.X..

XXXX
....
.OOO
.OX.

.OO.
.OO.
XXX.
.X..

..X.
O.XO
X.O.
..X.

.XOX
.O..
.O..
XOXX

....
XXTX
..OO
X.O.

OOOT
X...
X...
X...

XXOX
XOOT
OOXX
XXOO

.O..
...X
.O.X
...X

..O.
.OX.
XO..
XOX.

OOXO
OXXX
OXOO
OXXX

XOOO
XTOO
OOXX
XXXX

XTOX
OXOO
OXXO
XXXO

X..X
OOOO
X..X
XOOX

OO.X
X.O.
O..X
X..X

O.XX
.XXX
XT.O
OO.O

OOX.
X.OT
XOO.
X.X.

..X.
.OX.
O.XO
..X.

....
OOOO
TX..
XX.X

.O..
....
T.X.
....

XXO.
X.T.
.XOO
O.OX

O.TX
OOX.
.XXO
XOX.

XXXX
..OT
XOO.
O...

X...
OXO.
.OX.
...X

.XX.
XXO.
TOOO
....

X...
O.OT
XXXX
OO..

..X.
.X..
.O..
OX..

X.OX
XOTX
X.OO
XO..

O.OX
O.OX
O.OX
XXXX

....
XXXX
.O.O
.O..

..XO
..TX
XO..
O.XO

O...
.O.X
.XOX
X.OT

...X
X.X.
OOOO
.X..

OXXX
OOXX
XXOX
OOOO

O...
XOXX
.XOX
..OO

XXOX
OXXX
XOOO
XOOO

OXOO
XOXO
XOXX
XOOX

XOXO
OOXO
XOOX
XXOX

XOXO
.XX.
OOXO
..TX

X.O.
.XO.
.XOO
OXTX

.O..
XXXX
O...
.O..

X.XO
..OX
.OO.
OXX.

O.OX
O.XO
TXXX
X.O.

XOXX
XO..
.OXX
OOO.

OOXO
XOXX
OXOX
OXXO

';

$lines = explode("\n", $input);
$index = 0;
$games = array();
foreach ($lines as $line) {
    if (strlen(trim($line)) == 4) {
        if (!isset($games[$index])) {
            $games[$index] = array();
        }
        $games[$index][] = str_split(trim($line));
    } else if (strlen(trim($line)) == 0) {
        $index++;
    }
}

function check_line($line, $i) {
    $values = array_count_values($line);
    if (isset($values['X']) && ((isset($values['T']) && $values['X'] == 3 && $values['T'] == 1) || $values['X'] == 4)) {
        echo 'Case #' . ($i + 1) . ': X won';
        return true;
    }
    if (isset($values['O']) && ((isset($values['T']) && $values['O'] == 3 && $values['T'] == 1) || $values['O'] == 4)) {
        echo 'Case #' . ($i + 1) . ': O won';
        return true;
    }
    return false;
}

ob_start();

foreach($games as $index => $game) {
    if ($index > 0) {
        echo "\n";
    }
    $won = false;
    foreach($game as $line) {
        $won = check_line($line, $index);
        if ($won) {
            break;
        }
    }
    if (!$won) {
        for ($i = 0; $i < 4; $i++) {
            $line = array();
            for ($j = 0; $j < 4; $j++) {
                $line[] = $game[$j][$i];
            }
            $won = check_line($line, $index);
            if ($won) {
                break;
            }
        }
    }
    if (!$won) {
        $line = array(
            $game[0][0],
            $game[1][1],
            $game[2][2],
            $game[3][3],
        );
        $won = check_line($line, $index);
    }
    if (!$won) {
        $line = array(
            $game[0][3],
            $game[1][2],
            $game[2][1],
            $game[3][0],
        );
        $won = check_line($line, $index);
    }
    if (!$won) {
        $draw = true;
        for ($i = 0; $i < 4; $i++) {
            for ($j = 0; $j < 4; $j++) {
                if ($game[$i][$j] == '.') {
                    echo 'Case #' . ($index + 1). ': Game has not completed';
                    $draw = false;
                    break 2;
                }
            }
        }
        if ($draw) {
            echo 'Case #' . ($index + 1). ': Draw';
        }
    }
}

$answer = ob_get_contents();
ob_end_clean();
file_put_contents('answer-large.txt', $answer);